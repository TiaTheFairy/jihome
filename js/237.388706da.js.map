{"version":3,"file":"js/237.388706da.js","mappings":"mKAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACA,EAAG,MAAM,CAACA,EAAG,UAAU,CAACE,YAAY,OAAOC,MAAM,CAAC,OAAS,UAAU,CAACH,EAAG,aAAa,CAACE,YAAY,UAAUC,MAAM,CAAC,mBAAmB,SAASC,GAAG,CAAC,MAAQN,EAAIO,eAAe,CAACL,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,WAAW,CAACE,YAAY,WAAWC,MAAM,CAAC,IAAMG,EAAQ,SAAoCN,EAAG,OAAO,CAACE,YAAY,YAAY,CAACJ,EAAIS,GAAGT,EAAIU,GAAGV,EAAIW,GAAG,uBAAuB,KAAKT,EAAG,MAAM,CAACE,YAAY,OAAO,CAACF,EAAG,MAAM,CAACE,YAAY,SAAS,CAACF,EAAG,WAAW,CAACE,YAAY,WAAWC,MAAM,CAAC,YAAcJ,KAAKU,GAAG,iBAAiB,UAAY,IAAI,UAAY,MAAMC,MAAM,CAACC,MAAOb,EAAIc,MAAOC,SAAS,SAAUC,GAAMhB,EAAIc,MAAME,CAAG,EAAEC,WAAW,YAAY,GAAGf,EAAG,MAAM,CAACE,YAAY,UAAU,CAACF,EAAG,WAAW,CAACE,YAAY,WAAWC,MAAM,CAAC,YAAcJ,KAAKU,GAAG,kBAAkB,KAAO,WAAW,OAAS,OAAO,KAAO,KAAKC,MAAM,CAACC,MAAOb,EAAIkB,OAAQH,SAAS,SAAUC,GAAMhB,EAAIkB,OAAOF,CAAG,EAAEC,WAAW,aAAa,GAAGf,EAAG,MAAM,CAACE,YAAY,aAAaJ,EAAImB,GAAInB,EAAIoB,SAAS,SAASC,GAAM,OAAOnB,EAAG,MAAM,CAACoB,IAAID,EAAKE,GAAGnB,YAAY,eAAe,CAACF,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,YAAY,CAACE,YAAY,WAAWC,MAAM,CAAC,OAAS,2BAA2B,kBAAiB,EAAM,eAAeL,EAAIwB,cAAc,gBAAgBxB,EAAIyB,sBAAsB,CAAEJ,EAAKK,KAAMxB,EAAG,MAAM,CAACE,YAAY,cAAcC,MAAM,CAAC,IAAMgB,EAAKK,QAAQxB,EAAG,IAAI,CAACE,YAAY,4BAA6BiB,EAAKK,KAAMxB,EAAG,IAAI,CAACE,YAAY,2BAA2BE,GAAG,CAAC,MAAQ,SAASqB,GAAiC,OAAzBA,EAAOC,kBAAyB5B,EAAI6B,cAAcR,EAAKE,GAAG,KAAKvB,EAAI8B,QAAQ,IAAI,IAAG,GAAG5B,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,WAAW,CAACE,YAAY,WAAWC,MAAM,CAAC,YAAcJ,KAAKU,GAAG,iBAAiBC,MAAM,CAACC,MAAOb,EAAI0B,KAAMX,SAAS,SAAUC,GAAMhB,EAAI0B,KAAKV,CAAG,EAAEC,WAAW,WAAW,GAAGf,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACF,EAAG,OAAO,CAACF,EAAIS,GAAGT,EAAIU,GAAGV,EAAIW,GAAG,oBAAoBT,EAAG,OAAO,CAACE,YAAY,aAAa,CAACJ,EAAIS,GAAGT,EAAIU,GAAGV,EAAI+B,eAAe7B,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACF,EAAG,OAAO,CAACF,EAAIS,GAAGT,EAAIU,GAAGV,EAAIW,GAAG,sBAAsBT,EAAG,OAAO,CAACE,YAAY,aAAa,CAACF,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQL,EAAIW,GAAG,oBAAoB,UAAYX,EAAIgC,aAAapB,MAAM,CAACC,MAAOb,EAAIiC,OAAO,GAAIlB,SAAS,SAAUC,GAAMhB,EAAIkC,KAAKlC,EAAIiC,OAAQ,EAAGjB,EAAI,EAAEC,WAAW,eAAef,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQL,EAAIW,GAAG,oBAAoB,UAAYX,EAAIgC,aAAapB,MAAM,CAACC,MAAOb,EAAIiC,OAAO,GAAIlB,SAAS,SAAUC,GAAMhB,EAAIkC,KAAKlC,EAAIiC,OAAQ,EAAGjB,EAAI,EAAEC,WAAW,eAAef,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQL,EAAIW,GAAG,oBAAoB,UAAYX,EAAIgC,aAAapB,MAAM,CAACC,MAAOb,EAAIiC,OAAO,GAAIlB,SAAS,SAAUC,GAAMhB,EAAIkC,KAAKlC,EAAIiC,OAAQ,EAAGjB,EAAI,EAAEC,WAAW,eAAef,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQL,EAAIW,GAAG,oBAAoB,UAAYX,EAAIgC,aAAapB,MAAM,CAACC,MAAOb,EAAIiC,OAAO,GAAIlB,SAAS,SAAUC,GAAMhB,EAAIkC,KAAKlC,EAAIiC,OAAQ,EAAGjB,EAAI,EAAEC,WAAW,gBAAgB,OAAOf,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,YAAY,CAACE,YAAY,SAASC,MAAM,CAAC,KAAO,WAAWC,GAAG,CAAC,MAAQN,EAAImC,SAAS,CAACnC,EAAIS,GAAGT,EAAIU,GAAGV,EAAIW,GAAG,wBAAwB,MAAM,IAAI,IAC7kG,EACIyB,EAAkB,G,gDCoEtB,MAAAC,GAAAC,EAAAA,EAAAA,IAAA,gBAEA,OACAC,KAAA,WACAC,OACA,OACA1B,MAAA,GACAI,OAAA,GACAQ,KAAA,GACAe,KAAA,GACAV,SAAA,GACAE,OAAA,cACAD,aAAA,EACAZ,QAAA,EAAAG,GAAA,EAAAG,KAAA,OACAgB,WAAA,GACAC,QAAA,EAEA,EACAC,QAAA,CACArC,eACA,KAAAsC,KAAAC,MAAA,eACA,EACAC,UACA,MAAAC,EAAA,KAAAC,WAEAC,EAAAA,EAAAA,GAAA,CACAC,OAAA,OACAC,IAAAC,EAAAA,EAAAA,KACAb,KAAA,IAAAc,gBAAA,CACA,UACA,OAAAC,EAAAA,EAAAA,IAAA,eAEAC,MAAAC,IACAT,EAAAU,QACA,KAAAD,EAAAE,OACA,KAAAC,MAAA,KAAAjD,GAAA,4BAAAA,GAAA,iBAGA,gBAAA8C,EAAAjB,KACA,KAAAoB,MAAA,KAAAjD,GAAA,8BAAAA,GAAA,iBAEA,cAAA8C,EAAAjB,KAAAmB,OACAF,EAAAjB,KAAAqB,YAAA,GACA,KAAApB,KAAA,KAAAqB,eAAAL,EAAAjB,KAAAqB,WAAAJ,EAAAjB,KAAAuB,UACA,KAAAhC,SAAA,KAAAU,KACA,KAAAR,OAAAwB,EAAAjB,KAAAP,SAAA,EACAwB,EAAAjB,KAAAqB,WAAA,IACA,KAAA7B,aAAA,KAIA,KAAAgC,OAAA,KAAArD,GAAA,8BAAAA,GAAA,iBACA,KAAAkC,KAAAC,MAAA,iBAIA,KAAAc,MAAA,4BAAAjD,GAAA,gBAEA,GAEA,EACAwB,SACA,MAAA8B,EAAA,0IAEA,QAAAnD,MAAAoD,OAAA,QAAApD,MAAAoD,OAAA,SAAAhD,OAAAgD,OAAA,SAAAhD,OAAAgD,OAAA,IACA,KAAAN,MAAA,KAAAjD,GAAA,+BAAAA,GAAA,wBAEA,WAAAsB,OAAAkC,QAAAC,GAAAA,IAAAF,OACA,KAAAN,MAAA,KAAAjD,GAAA,yBAAAA,GAAA,wBAEA,GAAAsD,EAAAI,KAAA,KAAA3C,MAGA,CACA,MAAAsB,EAAA,KAAAC,UAEA,QAAAmB,KAAA,KAAAhD,QACA,WAAAA,QAAAgD,GAAA1C,MACA,KAAAgB,WAAA4B,KAAA,KAAAlD,QAAAgD,GAAA1C,KAAA6C,OAAA,KAAAnD,QAAAgD,GAAA1C,KAAA8C,QAAA,WAIAtB,EAAAA,EAAAA,GAAA,CACAC,OAAA,OACAC,IAAAC,EAAAA,EAAAA,SACAb,KAAA,IAAAc,gBAAA,CACA,OAAAC,EAAAA,EAAAA,IAAA,eACA,cAAAd,KACA,OAAAJ,IACA,WAAAvB,MACA,aAAAI,OACA,OAAAuD,KAAAC,UAAA,KAAAzC,QACA,UAAAP,KACA,aAAAgB,eAEAc,MAAAC,IAEA,GADAT,EAAAU,QACA,KAAAD,EAAAE,OACA,KAAAC,MAAA,KAAAjD,GAAA,4BAAAA,GAAA,qBAEA,CACA,wBAAA8C,EAAAjB,KAEA,YADA,KAAAL,SAGA,sBAAAsB,EAAAjB,KAAAmB,SACA,KAAAd,KAAAC,MAAA,mBACA,KAAAc,MAAA,KAAAjD,GAAA,6BAAAA,GAAA,0BACA,KAAAkC,KAAAC,MAAA,iBAAAW,EAAAjB,KAAAmC,OAAA,IAGA,IAEA,MA1CA,KAAAf,MAAA,KAAAjD,GAAA,wBAAAA,GAAA,kBA2CA,EACAa,cAAAoD,GACA,MAAA5B,EAAA,KAAAC,UAEA,IAAA4B,EAAA,IAAAC,SACAD,EAAAE,OAAA,OAAAH,EAAAA,MACAC,EAAAE,OAAA,eACAF,EAAAE,OAAA,SAAAxB,EAAAA,EAAAA,IAAA,aAEAL,EAAAA,EAAAA,GAAA,CACAC,OAAA,OACAC,IAAAC,EAAAA,EAAAA,UACAb,KAAAqC,IACArB,MAAAC,IACAT,EAAAU,QACA,KAAAD,EAAAE,OACA,KAAAC,MAAA,KAAAjD,GAAA,4BAAAA,GAAA,iBAGA,wBAAA8C,EAAAjB,KAAAmB,SACA,KAAAvC,QAAA4D,OAAA,KAAA5D,QAAA8C,OAAA,KACA,KAAA9C,QAAAkD,KAAA,CACA/C,GAAA,KAAAoB,QACAjB,KAAA2B,EAAAA,EAAAA,OAAAI,EAAAjB,KAAAjB,KAEA,KAAAoB,UACA,KAAAvB,QAAA8C,OAAA,GACA,KAAA9C,QAAAkD,KAAA,CACA/C,GAAA,KAAAoB,QACAjB,KAAA,OAIA,GAEA,EACAD,oBAAAmD,GACA,aAAAxD,QAAA8C,OAAA,KAGA,cAAAU,EAAAK,MAAA,aAAAL,EAAAK,MACA,KAAArB,MAAA,KAAAjD,GAAA,8BAAAA,GAAA,oBACA,KAEAiE,EAAAM,KAAA,eACA,KAAAtB,MAAA,KAAAjD,GAAA,6BAAAA,GAAA,oBACA,GAKA,EACAkB,cAAAN,GACA,IAAA4D,GAAA,EACAC,EAAA,GACA,QAAAhB,KAAA,KAAAhD,QACA,KAAAA,QAAAgD,GAAA7C,IAAAA,IACA6D,EAAA,KAAAhE,QAAAgD,GAAA1C,KACA,KAAAN,QAAA4D,OAAAZ,EAAA,IAEA,KAAAhD,QAAAgD,IACA,WAAAhD,QAAAgD,GAAA1C,OACAyD,GAAA,GAIAA,GACA,KAAA/D,QAAAkD,KAAA,CACA/C,GAAA,KAAAoB,QACAjB,KAAA,OAGA,MAAAsB,EAAA,KAAAC,WACAC,EAAAA,EAAAA,GAAA,CACAC,OAAA,OACAC,IAAAC,EAAAA,EAAAA,UACAb,KAAA,IAAAc,gBAAA,CACA8B,OAAAA,MAEA5B,MAAAC,IACAT,EAAAU,QACA,KAAAD,EAAAE,QACA,KAAAC,MAAA,KAAAjD,GAAA,4BAAAA,GAAA,gBACA,GAEA,GAEA0E,UACA,KAAAtC,SACA,GCjRyQ,I,UCQrQuC,GAAY,OACd,EACAvF,EACAqC,GACA,EACA,KACA,WACA,MAIF,EAAekD,EAAiB,O","sources":["webpack://jihome_front/./src/components/pages/page_news/NewsNew.vue","webpack://jihome_front/src/components/pages/page_news/NewsNew.vue","webpack://jihome_front/./src/components/pages/page_news/NewsNew.vue?d0f3","webpack://jihome_front/./src/components/pages/page_news/NewsNew.vue?1e04"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',[_c('el-card',{staticClass:\"card\",attrs:{\"shadow\":\"hover\"}},[_c('el-divider',{staticClass:\"divider\",attrs:{\"content-position\":\"right\"},on:{\"click\":_vm.backNewsList}},[_c('div',{staticClass:\"back\"},[_c('el-image',{staticClass:\"backIcon\",attrs:{\"src\":require('@/../public/assets/return.png')}}),_c('span',{staticClass:\"backWord\"},[_vm._v(_vm._s(_vm.$t('News.NewReturn')))])],1)]),_c('div',{staticClass:\"new\"},[_c('div',{staticClass:\"title\"},[_c('el-input',{staticClass:\"inputBox\",attrs:{\"placeholder\":this.$t('News.NewTitle'),\"minlength\":\"2\",\"maxlength\":\"16\"},model:{value:(_vm.title),callback:function ($$v) {_vm.title=$$v},expression:\"title\"}})],1),_c('div',{staticClass:\"detail\"},[_c('el-input',{staticClass:\"inputBox\",attrs:{\"placeholder\":this.$t('News.NewDetail'),\"type\":\"textarea\",\"resize\":\"none\",\"rows\":\"3\"},model:{value:(_vm.detail),callback:function ($$v) {_vm.detail=$$v},expression:\"detail\"}})],1),_c('div',{staticClass:\"uploadPic\"},_vm._l((_vm.picture),function(item){return _c('div',{key:item.id,staticClass:\"pictureList\"},[_c('div',{staticClass:\"pictureItem\"},[_c('el-upload',{staticClass:\"uploader\",attrs:{\"action\":\"server.default.uploadImg\",\"show-file-list\":false,\"http-request\":_vm.uploadPicture,\"before-upload\":_vm.beforePictureUpload}},[(item.link)?_c('img',{staticClass:\"uploadImage\",attrs:{\"src\":item.link}}):_c('i',{staticClass:\"el-icon-plus uploadIcon\"}),(item.link)?_c('i',{staticClass:\"el-icon-close removeIcon\",on:{\"click\":function($event){$event.stopPropagation();return _vm.removePicture(item.id)}}}):_vm._e()])],1)])}),0),_c('div',{staticClass:\"link\"},[_c('el-input',{staticClass:\"inputBox\",attrs:{\"placeholder\":this.$t('News.NewLink')},model:{value:(_vm.link),callback:function ($$v) {_vm.link=$$v},expression:\"link\"}})],1),_c('div',{staticClass:\"user\"},[_c('div',{staticClass:\"userauth userItem\"},[_c('span',[_vm._v(_vm._s(_vm.$t('News.NewUser')))]),_c('span',{staticClass:\"userRight\"},[_vm._v(_vm._s(_vm.userShow))])]),_c('div',{staticClass:\"school userItem\"},[_c('span',[_vm._v(_vm._s(_vm.$t('News.NewSchool')))]),_c('span',{staticClass:\"userRight\"},[_c('el-checkbox',{attrs:{\"label\":_vm.$t(\"User.UserSchool0\"),\"disabled\":!_vm.schoolAllow},model:{value:(_vm.school[0]),callback:function ($$v) {_vm.$set(_vm.school, 0, $$v)},expression:\"school[0]\"}}),_c('el-checkbox',{attrs:{\"label\":_vm.$t(\"User.UserSchool1\"),\"disabled\":!_vm.schoolAllow},model:{value:(_vm.school[1]),callback:function ($$v) {_vm.$set(_vm.school, 1, $$v)},expression:\"school[1]\"}}),_c('el-checkbox',{attrs:{\"label\":_vm.$t(\"User.UserSchool2\"),\"disabled\":!_vm.schoolAllow},model:{value:(_vm.school[2]),callback:function ($$v) {_vm.$set(_vm.school, 2, $$v)},expression:\"school[2]\"}}),_c('el-checkbox',{attrs:{\"label\":_vm.$t(\"User.UserSchool3\"),\"disabled\":!_vm.schoolAllow},model:{value:(_vm.school[3]),callback:function ($$v) {_vm.$set(_vm.school, 3, $$v)},expression:\"school[3]\"}})],1)])]),_c('div',{staticClass:\"buttons\"},[_c('el-button',{staticClass:\"button\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.submit}},[_vm._v(_vm._s(_vm.$t('News.NewConfirm')))])],1)])],1)],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div>\r\n      <el-card shadow='hover' class='card'>\r\n        <el-divider class='divider' content-position=\"right\" @click='backNewsList'>\r\n          <div class='back'>\r\n            <el-image class='backIcon' :src=\"require('@/../public/assets/return.png')\"></el-image>\r\n            <span class='backWord'>{{$t('News.NewReturn')}}</span>\r\n          </div>\r\n        </el-divider>\r\n\r\n        <div class='new'>\r\n          <div class='title'>\r\n            <el-input class='inputBox' :placeholder=\"this.$t('News.NewTitle')\" minlength=\"2\" maxlength=\"16\"\r\n              v-model='title'></el-input>\r\n          </div>\r\n\r\n          <div class='detail'>\r\n            <el-input class='inputBox' :placeholder=\"this.$t('News.NewDetail')\" type=\"textarea\" resize='none'\r\n              v-model='detail' rows='3'></el-input>\r\n          </div>\r\n\r\n          <div class='uploadPic'>\r\n            <div class='pictureList' v-for='item in picture' v-bind:key='item.id'>\r\n              <div class='pictureItem'>\r\n                <el-upload class=\"uploader\" action=\"server.default.uploadImg\" :show-file-list=\"false\"\r\n                  :http-request=\"uploadPicture\" :before-upload=\"beforePictureUpload\">\r\n                  <img v-if='item.link' :src='item.link' class=\"uploadImage\" />\r\n                  <i v-else class=\"el-icon-plus uploadIcon\"></i>\r\n                  <i v-if='item.link' class='el-icon-close removeIcon' @click.stop='removePicture(item.id)'></i>\r\n                </el-upload>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class='link'>\r\n            <el-input class='inputBox' :placeholder=\"this.$t('News.NewLink')\" v-model='link'></el-input>\r\n          </div>\r\n\r\n          <div class='user'>\r\n            <div class='userauth userItem'>\r\n              <span>{{$t('News.NewUser')}}</span>\r\n              <span class='userRight'>{{userShow}}</span>\r\n            </div>\r\n\r\n            <div class='school userItem'>\r\n              <span>{{$t('News.NewSchool')}}</span>\r\n              <span class='userRight'>\r\n                <el-checkbox :label='$t(\"User.UserSchool0\")' v-model='school[0]' :disabled='!schoolAllow'></el-checkbox>\r\n                <el-checkbox :label='$t(\"User.UserSchool1\")' v-model='school[1]' :disabled='!schoolAllow'></el-checkbox>\r\n                <el-checkbox :label='$t(\"User.UserSchool2\")' v-model='school[2]' :disabled='!schoolAllow'></el-checkbox>\r\n                <el-checkbox :label='$t(\"User.UserSchool3\")' v-model='school[3]' :disabled='!schoolAllow'></el-checkbox>\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          <div class='buttons'>\r\n            <el-button class='button' type='primary' @click='submit'>{{$t('News.NewConfirm')}}</el-button>\r\n          </div>\r\n        </div>\r\n      </el-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport Cookies from 'js-cookie'\r\nimport * as server from '../../../server.js'\r\nimport { customAlphabet } from 'nanoid';\r\nconst nanoid = customAlphabet('1234567890', 9);\r\n\r\nexport default {\r\n  name: 'news-new',\r\n  data () {\r\n    return {\r\n      title: '',\r\n      detail: '',\r\n      link: '',\r\n      user: '',\r\n      userShow: '',\r\n      school: [false, false, false, false],\r\n      schoolAllow: false,\r\n      picture: [{ id: 0, link: null }],\r\n      pictureRaw: [],\r\n      idCount: 0\r\n    }\r\n  },\r\n  methods: {\r\n    backNewsList () {\r\n      this.$bus.$emit('showNewsList')\r\n    },\r\n    getUser () {\r\n      const loadingInstance = this.loading();\r\n\r\n      axios({\r\n        method: 'post',\r\n        url: server.default.user,\r\n        data: new URLSearchParams({\r\n          'type': 'me',\r\n          'cookie': Cookies.get('loginAs')\r\n        })\r\n      }).then((response) => {\r\n        loadingInstance.close();\r\n        if (response.status != 200) {\r\n          this.alert(this.$t('System.NetworkIssue'), this.$t('System.Error'))\r\n        }\r\n        else {\r\n          if (response.data == 'USER_NOMATCH') {\r\n            this.alert(this.$t('System.IllegalRequest'), this.$t('System.Error'));\r\n          }\r\n          else if (response.data.status == 'USER_FOUND') {\r\n            if (response.data.userstatus >= 2) {\r\n              this.user = this.formatUserType(response.data.userstatus, response.data.authname);\r\n              this.userShow = this.user;\r\n              this.school[response.data.school] = true;\r\n              if (response.data.userstatus > 2) {\r\n                this.schoolAllow = true;\r\n              }\r\n            }\r\n            else {\r\n              this.$alert(this.$t('System.IllegalRequest'), this.$t('System.Error'));\r\n              this.$bus.$emit('showNewsList');\r\n            }\r\n          }\r\n          else {\r\n            this.alert('Unexpected Response!', this.$t('System.Error'));\r\n          }\r\n        }\r\n      });\r\n    },\r\n    submit () {\r\n      const linkRegx = /(https?:\\/\\/)?(([0-9a-z.]+\\.[a-z]+)|(([0-9]{1,3}\\.){3}[0-9]{1,3}))(:[0-9]+)?(\\/[0-9a-z%/.\\-_]*)?(\\?[0-9a-z=&%_-]*)?(#[0-9a-z=&%_-]*)?/ig\r\n\r\n      if (this.title.length < 5 || this.title.length > 16 || this.detail.length < 10 || this.detail.length > 300) {\r\n        this.alert(this.$t('News.NewInputLengthBad'), this.$t('System.Warning'));\r\n      }\r\n      else if (this.school.filter((i) => { return i }).length == 0) {\r\n        this.alert(this.$t('News.NewNoSchool'), this.$t('System.Warning'));\r\n      }\r\n      else if (!linkRegx.test(this.link)) {\r\n        this.alert(this.$t('News.NewLinkBad'), this.$t('System.Warning'));\r\n      }\r\n      else {\r\n        const loadingInstance = this.loading();\r\n\r\n        for (let i in this.picture) {\r\n          if (this.picture[i].link != null) {\r\n            this.pictureRaw.push(this.picture[i].link.substr(this.picture[i].link.indexOf('/img')))\r\n          }\r\n        }\r\n\r\n        axios({\r\n          method: 'post',\r\n          url: server.default.postNews,\r\n          data: new URLSearchParams({\r\n            'cookie': Cookies.get('loginCookie'),\r\n            'userauth': this.user,\r\n            'newsid': nanoid(),\r\n            'title': this.title,\r\n            'content': this.detail,\r\n            'school': JSON.stringify(this.school),\r\n            'link': this.link,\r\n            'picture': this.pictureRaw\r\n          })\r\n        }).then((response) => {\r\n          loadingInstance.close();\r\n          if (response.status != 200) {\r\n            this.alert(this.$t('System.NetworkIssue'), this.$t('System.Error'))\r\n          }\r\n          else {\r\n            if (response.data == 'NEWS_NEWSID_TAKEN') {\r\n              this.submit();\r\n              return;\r\n            }\r\n            else if (response.data.status == 'NEWS_POST_COMPLETE') {\r\n              this.$bus.$emit('refreshNewsList');\r\n              this.alert(this.$t('News.NewCompleteJump'), this.$t('News.NewComplete'), () => {\r\n                this.$bus.$emit('showNewsDetail', response.data.newsid);\r\n              })\r\n            }\r\n          }\r\n        })\r\n      }\r\n    },\r\n    uploadPicture (file) {\r\n      const loadingInstance = this.loading();\r\n\r\n      let formData = new FormData();\r\n      formData.append(\"file\", file.file);\r\n      formData.append(\"type\", \"news\");\r\n      formData.append(\"cookie\", Cookies.get('loginAs'))\r\n\r\n      axios({\r\n        method: \"post\",\r\n        url: server.default.uploadImg,\r\n        data: formData\r\n      }).then((response) => {\r\n        loadingInstance.close();\r\n        if (response.status != 200) {\r\n          this.alert(this.$t('System.NetworkIssue'), this.$t('System.Error'))\r\n        }\r\n        else {\r\n          if (response.data.status == 'IMAGE_UPLOAD_SUCCESS') {\r\n            this.picture.splice(this.picture.length - 1, 1);\r\n            this.picture.push({\r\n              id: this.idCount,\r\n              link: server.default.server + response.data.id\r\n            });\r\n            this.idCount++;\r\n            if (this.picture.length < 3) {\r\n              this.picture.push({\r\n                id: this.idCount,\r\n                link: null\r\n              })\r\n            }\r\n          }\r\n        }\r\n      });\r\n    },\r\n    beforePictureUpload (file) {\r\n      if (this.picture.length > 3) {\r\n        return false;\r\n      }\r\n      else if (file.type != 'image/jpeg' && file.type != 'image/png') {\r\n        this.alert(this.$t('News.PictureWrongType'), this.$t('System.Warning'));\r\n        return false;\r\n      }\r\n      else if (file.size / 1024 / 1024 > 2) {\r\n        this.alert(this.$t('News.PictureTooLarge'), this.$t('System.Warning'));\r\n        return false;\r\n      }\r\n      else {\r\n        return true;\r\n      }\r\n    },\r\n    removePicture (id) {\r\n      let isAnyEmpty = false;\r\n      let target = '';\r\n      for (let i in this.picture) {\r\n        if (this.picture[i].id == id) {\r\n          target = this.picture[i].link;\r\n          this.picture.splice(i, 1);\r\n        }\r\n        if (this.picture[i]) {\r\n          if (this.picture[i].link == null) {\r\n            isAnyEmpty = true;\r\n          }\r\n        }\r\n      }\r\n      if (!isAnyEmpty) {\r\n        this.picture.push({\r\n          id: this.idCount,\r\n          link: null\r\n        })\r\n      }\r\n      const loadingInstance = this.loading();\r\n      axios({\r\n        method: \"post\",\r\n        url: server.default.removeImg,\r\n        data: new URLSearchParams({\r\n          target: target,\r\n        })\r\n      }).then((response) => {\r\n        loadingInstance.close();\r\n        if (response.status != 200) {\r\n          this.alert(this.$t('System.NetworkIssue'), this.$t('System.Error'))\r\n        }\r\n      });\r\n    }\r\n  },\r\n  mounted () {\r\n    this.getUser();\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.card {\r\n  margin-left: 5%;\r\n  width: 90%;\r\n  border-radius: 20px;\r\n}\r\n.new {\r\n  width: 90%;\r\n  margin-left: 5%;\r\n}\r\n.divider {\r\n  width: 90%;\r\n  margin-left: 5%;\r\n}\r\n.back {\r\n  cursor: pointer;\r\n}\r\n.backIcon {\r\n  color: rgb(252, 62, 5);\r\n  width: 20px;\r\n}\r\n.backWord {\r\n  font-size: 18px;\r\n  margin-left: 10px;\r\n}\r\n.inputBox {\r\n  margin-top: 30px;\r\n  font-size: 20px;\r\n}\r\n.inputBox ::v-deep textarea {\r\n  border-radius: 15px;\r\n}\r\n.inputBox ::v-deep .el-input__inner {\r\n  border-radius: 10px;\r\n}\r\n.uploadPic {\r\n  margin-top: 30px;\r\n  margin-bottom: 30px;\r\n  text-align: left;\r\n  display: flex;\r\n  flex-direction: row;\r\n}\r\n.uploadPic .pictureItem {\r\n  margin-right: 15px;\r\n}\r\n.uploadPic .uploader .el-upload {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n.uploadPic .uploader .el-upload:hover {\r\n  border-color: #409eff;\r\n}\r\n.uploadPic .uploader .uploadIcon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 178px;\r\n  height: 178px;\r\n  line-height: 178px;\r\n  text-align: center;\r\n  border: 1px solid gray;\r\n  border-radius: 15px;\r\n}\r\n.uploadPic .uploader .removeIcon {\r\n  font-size: 28px;\r\n  font-weight: bolder;\r\n  position: relative;\r\n  top: -178px;\r\n  left: 75px;\r\n}\r\n.uploadPic .uploader .uploadImage {\r\n  width: 178px;\r\n  height: 178px;\r\n  display: block;\r\n  border: 1px solid gray;\r\n  border-radius: 15px;\r\n}\r\n.userItem {\r\n  margin-top: 20px;\r\n  text-align: left;\r\n  font-size: 20px;\r\n}\r\n.userRight {\r\n  float: right;\r\n}\r\n.button {\r\n  font-size: 20px;\r\n  margin-left: 15px;\r\n  margin-right: 15px;\r\n  margin-top: 30px;\r\n}\r\n</style>","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./NewsNew.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./NewsNew.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./NewsNew.vue?vue&type=template&id=7ff42c52&scoped=true&\"\nimport script from \"./NewsNew.vue?vue&type=script&lang=js&\"\nexport * from \"./NewsNew.vue?vue&type=script&lang=js&\"\nimport style0 from \"./NewsNew.vue?vue&type=style&index=0&id=7ff42c52&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7ff42c52\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","backNewsList","require","_v","_s","$t","model","value","title","callback","$$v","expression","detail","_l","picture","item","key","id","uploadPicture","beforePictureUpload","link","$event","stopPropagation","removePicture","_e","userShow","schoolAllow","school","$set","submit","staticRenderFns","nanoid","customAlphabet","name","data","user","pictureRaw","idCount","methods","$bus","$emit","getUser","loadingInstance","loading","axios","method","url","server","URLSearchParams","Cookies","then","response","close","status","alert","userstatus","formatUserType","authname","$alert","linkRegx","length","filter","i","test","push","substr","indexOf","JSON","stringify","newsid","file","formData","FormData","append","splice","type","size","isAnyEmpty","target","mounted","component"],"sourceRoot":""}