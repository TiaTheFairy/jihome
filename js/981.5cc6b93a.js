"use strict";(self["webpackChunkjihome_front"]=self["webpackChunkjihome_front"]||[]).push([[981],{8981:function(t,s,e){e.r(s),e.d(s,{default:function(){return k}});var i=function(){var t=this,s=t._self._c;return s("div",[s("div",[s("el-card",{staticClass:"card",attrs:{shadow:"hover"}},[s("el-divider",{staticClass:"divider",attrs:{"content-position":"right"},on:{click:t.closeNewsDetail}},[s("div",{staticClass:"back"},[s("el-image",{staticClass:"backIcon",attrs:{src:e(7596)}}),s("span",{staticClass:"backWord"},[t._v(t._s(t.$t("News.DetailReturn")))])],1)]),s("div",{staticClass:"content"},[s("div",[s("div",{staticClass:"title"},[t._v(t._s(t.title))]),s("div",{staticClass:"detail"},[t._v(t._s(t.content))]),s("div",{staticClass:"picture"},t._l(t.picture,(function(t){return s("span",{key:t},[s("span",{staticClass:"pictureItem"},[s("el-image",{attrs:{src:t,width:"200px"}})],1)])})),0)]),s("div",{staticClass:"footer"},[s("div",{staticClass:"auth"},[s("span",{staticClass:"userAuth"},[t._v(t._s(t.userAuth))]),s("span",{staticClass:"school"},[t._v(t._s(t.schoolFormatted))])]),s("div",{staticClass:"user"},[s("span",{staticClass:"username",on:{click:function(s){return t.openUserPage(t.userID)}}},[t._v(t._s(t.$t("News.DetailAuthor"))+t._s(t.username)+" ("+t._s(t.realname)+")")]),s("span",{staticClass:"link",on:{click:function(s){return t.openLink()}}},[t._v(t._s(t.$t("News.DetailLink")))])])])]),s("div",{staticClass:"footer"},[s("div",{staticClass:"action"},[s("span",{staticClass:"time"},[t._v(t._s(t.time))]),s("span",{staticClass:"buttons"},[t.alreadyLike?t._e():s("span",{staticClass:"like",on:{click:t.clickLike}},[s("el-image",{staticClass:"aAction",attrs:{src:e(4065)}}),s("span",[t._v("("+t._s(t.like)+")")])],1),t.alreadyLike?s("span",{staticClass:"like",on:{click:t.clickLike}},[s("el-image",{staticClass:"aAction",attrs:{src:e(1139)}}),s("span",[t._v("("+t._s(t.like)+")")])],1):t._e(),s("el-image",{staticClass:"aAction",attrs:{src:e(8359)},on:{click:t.clickShare}}),t.isOwner||t.isAdmin?s("el-image",{staticClass:"aAction",attrs:{src:e(8889)},on:{click:t.clickDelete}}):t._e()],1)]),s("div",{staticClass:"comment"},[s("span",{staticClass:"commentBox"},[s("el-input",{staticClass:"inputBox",attrs:{placeholder:this.$t("Hollow.DetailCommentTip"),type:"textarea",resize:"none",rows:"3"},model:{value:t.inputComment,callback:function(s){t.inputComment=s},expression:"inputComment"}})],1),s("el-badge",{staticClass:"commentButtons",attrs:{value:t.commentsAmount}},[s("el-button",{attrs:{type:"primary"},on:{click:function(s){return t.submitComment(0)}}},[t._v(t._s(t.$t("Hollow.DetailCommentSend")))])],1)],1)])],1),s("div",{staticClass:"comments"},t._l(t.comments,(function(i){return s("div",{key:i.commentid,ref:i.commentid,refInFor:!0,staticClass:"aComment"},[s("el-card",{staticClass:"card comment",attrs:{shadow:"hover"}},[s("div",{staticClass:"commentTop"},[s("span",{staticClass:"commentUsername",on:{click:function(s){return t.openUserPage(i.userid)}}},[t._v(t._s(i.username))]),s("span",{staticClass:"commentSchool"},[t._v(t._s(i.school))]),s("span",{staticClass:"commentTime"},[t._v(t._s(i.time))])]),s("div",{staticClass:"commentContent"},[s("span",{staticClass:"commentDetail"},[t._v(t._s(i.content))])]),s("div",{staticClass:"commentRight"},[i.isOwner||t.isAdmin?s("el-image",{staticClass:"aAction",attrs:{src:e(8889)},on:{click:function(s){return t.deleteComment(i.commentid)}}}):s("el-image",{staticClass:"aAction",attrs:{src:e(1283)},on:{click:function(s){return t.clickReport("nc",i.commentid)}}})],1)])],1)})),0)],1)])},a=[],n=(e(7658),e(4161)),o=e(680),l=e(1780),r=e(691);const c=(0,r.kP)("1234567890",9);var m={name:"news-detail",data(){return{newsID:0,userID:0,username:"",realname:"",userAuth:"",title:"",content:"",link:"",schoolArray:[],isOwner:!1,alreadyLike:!1,time:"",picture:[],comments:[],commentsAmount:0,like:0,inputComment:"",isAdmin:!1}},computed:{schoolFormatted(){let t="";for(let s in this.schoolArray)1==this.schoolArray[s]&&(t+=this.$t("User.UserSchool"+s)+" ");return t}},methods:{clickShare(){this.copyLink(this.$t("News.DetailShared"))},closeNewsDetail(){this.$bus.$emit("showNewsList")},getNewsDetail(){const t=this.loading();(0,n.Z)({method:"post",url:l.Z.getNewsItem,data:new URLSearchParams({newsid:this.newsID,cookie:o.Z.get("loginCookie")})}).then((s=>{if(t.close(),200!=s.status)this.alert(this.$t("System.NetworkIssue"),this.$t("System.Error"));else if("NEWS_GETITEM_COMPLETE"==s.data.status){if(this.newsID==s.data.newsid){if(this.userID=s.data.userid,this.username=s.data.username,this.realname=s.data.realname,this.userAuth=s.data.userauth,this.title=s.data.title,this.content=s.data.content,this.link=s.data.link,this.schoolArray=JSON.parse(s.data.school),this.isOwner=s.data.isOwner,this.alreadyLike=s.data.alreadyLike,this.time=this.formatTime(s.data.time),s.data.picture.length>0)for(let t in s.data.picture.split(","))this.picture.push(l.Z.server+s.data.picture.split(",")[t]);this.comments=s.data.comments,this.commentsAmount=this.comments.length,this.like=s.data.likes;for(let t in this.comments)this.comments[t].time=this.formatTime(this.comments[t].time),this.comments[t].school=this.formatSchool(this.comments[t].school);setTimeout((()=>{if(localStorage.getItem("adminworkReportShowOriginalCommentID")){let t=localStorage.getItem("adminworkReportShowOriginalCommentID");this.$refs[t][0]&&(this.$refs[t][0].scrollIntoView({behavior:"smooth",block:"center"}),this.$refs[t][0].style="background-color: red;border-radius:15px;"),localStorage.removeItem("adminworkReportShowOriginalCommentID")}}),1e3)}}else this.notfound()}))},clickLike(){if(this.alreadyLike)this.$message.error(this.$t("News.DetailLiked"));else{const t=this.loading();(0,n.Z)({method:"post",url:l.Z.postNewsLike,data:new URLSearchParams({cookie:o.Z.get("loginCookie"),newsid:this.newsID})}).then((s=>{t.close(),200!=s.status?this.alert(this.$t("System.NetworkIssue"),this.$t("System.Error")):"NEWS_LIKE_COMPLETE"==s.data&&this.redirect("newsDetail",this.newsID)}))}},clickDelete(){(this.isOwner||this.isAdmin)&&this.$confirm(this.$t("News.DetailDeleteWarn"),this.$t("System.Warning"),{confirmButtonText:this.$t("System.Yes"),cancelButtonText:this.$t("System.No"),type:"warning"}).then((()=>{const t=this.loading();(0,n.Z)({method:"post",url:l.Z.deleteNewsItem,data:new URLSearchParams({cookie:o.Z.get("loginCookie"),newsid:this.newsID})}).then((s=>{t.close(),200!=s.status?this.alert(this.$t("System.NetworkIssue"),this.$t("System.Error")):"NEWS_DELETE_COMPLETE"==s.data&&(this.$message.success(this.$t("News.DetailDeleteComplete")),this.$bus.$emit("refreshNewsList"),this.$bus.$emit("showNewsList"))}))}))},deleteComment(t){for(let s of this.comments){(t==s.commentid||this.isAdmin)&&this.$confirm(this.$t("News.DetailDeleteWarn"),this.$t("System.Warning"),{confirmButtonText:this.$t("System.Yes"),cancelButtonText:this.$t("System.No"),type:"warning"}).then((()=>{const s=this.loading();(0,n.Z)({method:"post",url:l.Z.deleteNewsComment,data:new URLSearchParams({cookie:o.Z.get("loginCookie"),newsid:this.newsID,commentid:t})}).then((t=>{s.close(),200!=t.status?this.alert(this.$t("System.NetworkIssue"),this.$t("System.Error")):"NEWS_DELETE_COMPLETE"==t.data&&(this.$message.success(this.$t("News.DetailDeleteComplete")),this.getNewsDetail())}))}));break}},clickReport(t,s){this.$prompt(this.$t("General.ReportReason"),this.$t("General.Report"),{}).then((e=>{e.value&&this.report(o.Z.get("loginCookie"),t,s,e.value,location.href)}))},submitComment(){if(this.inputComment.length<2||this.title.length>20)this.alert(this.$t("News.DetailCommentBadLength"),this.$t("System.Warning"));else{const t=this.loading();(0,n.Z)({method:"post",url:l.Z.postNewsComment,data:new URLSearchParams({cookie:o.Z.get("loginCookie"),content:this.inputComment,newsid:this.newsID,commentid:c()})}).then((s=>{if(t.close(),200!=s.status)this.alert(this.$t("System.NetworkIssue"),this.$t("System.Error"));else{if("NEWS_COMMENTID_TAKEN"==s.data)return void this.submitComment();"NEWS_COMMENT_COMPLETE"==s.data&&this.redirect("newsDetail",this.newsID)}}))}},openLink(){this.link.includes("http")||(this.link.includes("www")?this.link="https://"+this.link:this.link="https://www."+this.link),window.open(this.link,"_blank")}},mounted(){this.newsID=this.$route.params.id,this.getNewsDetail(),this.isAdmin=this.getIfAdmin()}},h=m,d=e(1001),u=(0,d.Z)(h,i,a,!1,null,"5499e65a",null),k=u.exports}}]);
//# sourceMappingURL=981.5cc6b93a.js.map